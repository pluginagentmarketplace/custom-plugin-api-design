# API Design Configuration
# Production-ready API architecture patterns

version: "1.0.0"

# API Style Selection
api_styles:
  rest:
    enabled: true
    maturity_level: 3  # Richardson Maturity Model (0-3)
    versioning: "path"  # path | header | query

  graphql:
    enabled: true
    introspection: false  # Disable in production
    depth_limit: 10
    complexity_limit: 1000

  hybrid:
    public_api: "rest"
    internal_api: "graphql"

# Versioning Strategy
versioning:
  strategy: "path"  # path | header | query
  current_version: "v1"
  deprecated_versions: []
  sunset_period_days: 180

  path:
    pattern: "/api/{version}/{resource}"
    example: "/api/v1/users"

  header:
    header_name: "Accept"
    pattern: "application/vnd.{company}.{version}+json"
    example: "application/vnd.example.v2+json"

  query:
    parameter: "version"
    pattern: "?version={version}"
    example: "?version=2"

# Response Format
response:
  success:
    envelope: true
    format:
      data: "object|array"
      meta: "object"
      links: "object"  # HATEOAS

  error:
    format:
      errors:
        - code: "string"
          message: "string"
          status: "number"
          details: "object"

  pagination:
    style: "cursor"  # cursor | offset | keyset
    default_page_size: 20
    max_page_size: 100

    cursor:
      encode: "base64"
      include_total: false

    offset:
      include_total: true
      max_offset: 10000

# HTTP Standards
http:
  methods:
    GET: "Read resource(s)"
    POST: "Create resource"
    PUT: "Replace resource"
    PATCH: "Partial update"
    DELETE: "Remove resource"
    OPTIONS: "CORS preflight"
    HEAD: "Check existence"

  status_codes:
    success:
      200: "OK - Request succeeded"
      201: "Created - Resource created"
      204: "No Content - Deletion succeeded"

    client_error:
      400: "Bad Request - Invalid input"
      401: "Unauthorized - Auth required"
      403: "Forbidden - Insufficient permissions"
      404: "Not Found - Resource doesn't exist"
      409: "Conflict - State conflict"
      422: "Unprocessable Entity - Validation failed"
      429: "Too Many Requests - Rate limited"

    server_error:
      500: "Internal Server Error"
      502: "Bad Gateway"
      503: "Service Unavailable"
      504: "Gateway Timeout"

# Security Defaults
security:
  authentication:
    methods:
      - "bearer_token"
      - "api_key"
      - "oauth2"
    token_expiry: 3600
    refresh_enabled: true

  rate_limiting:
    enabled: true
    window_ms: 900000  # 15 minutes
    max_requests: 1000

  cors:
    enabled: true
    origins: []  # Configure per environment
    methods: ["GET", "POST", "PUT", "PATCH", "DELETE"]
    headers: ["Content-Type", "Authorization"]

  headers:
    required:
      - "Content-Type"
    security:
      - "X-Content-Type-Options: nosniff"
      - "X-Frame-Options: DENY"
      - "Strict-Transport-Security: max-age=31536000"

# Caching
caching:
  enabled: true
  default_max_age: 3600

  patterns:
    static:
      max_age: 86400
      public: true

    dynamic:
      max_age: 0
      must_revalidate: true

    private:
      max_age: 300
      private: true

  etag:
    enabled: true
    weak: false

# Documentation
documentation:
  format: "openapi"  # openapi | asyncapi
  version: "3.1.0"

  paths:
    spec: "/api/openapi.json"
    docs: "/api/docs"
    redoc: "/api/redoc"

  auto_generate: true
  include_examples: true

# Monitoring
monitoring:
  metrics:
    enabled: true
    path: "/metrics"

  health:
    liveness: "/health/live"
    readiness: "/health/ready"

  logging:
    level: "info"
    format: "json"
    include_request_id: true
